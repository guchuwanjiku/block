<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Number Blocks Applet</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      body {
        margin: 0;
        font-family: 'Arial', sans-serif;
        background: #f0f8ff;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }

      #applet-frame {
        width: 90vw;
        max-width: 1280px;
        aspect-ratio: 16 / 9;
        background: white;
        padding: 1rem;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      #scene {
        flex-grow: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 1rem 0;
      }

      #blocks-container {
        display: flex;
        gap: 5px;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
      }

      .controls {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 1rem;
      }

      .navigation {
        display: flex;
        justify-content: space-between;
      }

      #narrator-text {
        font-size: 1.2rem;
        text-align: center;
        margin-bottom: 0.8rem;
        min-height: 2.5rem;
      }

      select {
        font-size: 1rem;
      }
    </style>
  </head>
  <body>
    <div id="applet-frame">
      <div class="header">
        <h1 id="title">Number Blocks</h1>
        <select id="language-select">
          <option value="en">English</option>
          <option value="id">Bahasa</option>
          <option value="tl">Tagalog</option>
        </select>
      </div>

      <div id="scene">
        <div id="blocks-container"></div>
      </div>

      <div class="controls">
        <label for="rod-slider">Number of Rods:</label>
        <input type="range" min="1" max="10" value="1" id="rod-slider" />
        <span id="rod-value">1</span>
      </div>

      <div id="narrator-text">Use the slider to explore multiplication!</div>

      <div class="navigation">
        <button id="prev-btn">Previous</button>
        <button id="next-btn">Next</button>
      </div>
    </div>

    <!-- Language Packs -->
    <script>
      const lang_en = {
        steps: [
          'Start with unit blocks.',
          'Combine them into a rod of 2.',
          'Now join 2 rods to make 4.',
          "Great! That's multiplication!",
          'Try making 6, 8, or 10!',
        ],
        default: 'Use the slider to explore multiplication!',
      }

      const lang_id = {
        steps: [
          'Mulai dengan blok unit.',
          'Gabungkan menjadi batang bernilai 2.',
          'Gabungkan 2 batang menjadi 4.',
          'Bagus! Itu adalah perkalian!',
          'Coba buat 6, 8, atau 10!',
        ],
        default: 'Gunakan slider untuk menjelajah perkalian!',
      }

      const lang_tl = {
        steps: [
          'Magsimula sa mga unit block.',
          'Pagsamahin upang maging rod na may halagang 2.',
          'Pagsamahin ang 2 rod para maging 4.',
          'Ayos! Iyan ang multiplication!',
          'Subukang gumawa ng 6, 8, o 10!',
        ],
        default: 'Gamitin ang slider para matutunan ang multiplication!',
      }
    </script>

    <!-- App Logic -->
    <script>
      let step = 0
      let currentLang = 'en'
      const texts = { en: lang_en, id: lang_id, tl: lang_tl }

      const container = document.getElementById('blocks-container')
      const slider = document.getElementById('rod-slider')
      const rodValue = document.getElementById('rod-value')
      const narrator = document.getElementById('narrator-text')
      const nextBtn = document.getElementById('next-btn')
      const prevBtn = document.getElementById('prev-btn')
      const langSelect = document.getElementById('language-select')

      function renderBlocks(count) {
        container.innerHTML = ''
        for (let i = 0; i < count; i++) {
          const block = document.createElementNS(
            'http://www.w3.org/2000/svg',
            'svg'
          )
          block.setAttribute('width', '60')
          block.setAttribute('height', '60')
          block.innerHTML = `
          <rect width="60" height="60" rx="8" ry="8" fill="#00BCD4" stroke="#007e8c" stroke-width="3"/>
          <text x="30" y="35" text-anchor="middle" font-size="24" fill="white" font-family="Arial">2</text>
        `
          container.appendChild(block)
        }
      }

      function updateNarration() {
        narrator.textContent =
          texts[currentLang].steps[step] || texts[currentLang].default
      }

      slider.addEventListener('input', () => {
        rodValue.textContent = slider.value
        renderBlocks(parseInt(slider.value))
        narrator.textContent = `Total: ${slider.value * 2}`
      })

      nextBtn.addEventListener('click', () => {
        step++
        updateNarration()
      })

      prevBtn.addEventListener('click', () => {
        step = Math.max(0, step - 1)
        updateNarration()
      })

      langSelect.addEventListener('change', () => {
        currentLang = langSelect.value
        updateNarration()
      })

      // Initial render
      renderBlocks(parseInt(slider.value))
      updateNarration()
    </script>
  </body>
</html>
